<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>BYTE-90 Firmeware Update</title>
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <main>
        <div class="card-wrapper">
            <div class="card">
                <div class="card__header">
                    <div class="byte-logo">
                        <svg fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 424 101">
                            <path fill="currentColor" d="M0 0h424v101H0z" />
                            <path
                                d="M235.891 62.535c.576 0 1.073.209 1.492.627.418.419.627.916.627 1.492l-.898 11.066a2.04 2.04 0 0 1-.628 1.492 2.038 2.038 0 0 1-1.491.627h-49.604c-.576 0-1.073-.209-1.492-.627a2.039 2.039 0 0 1-.627-1.492l5.991-50.702c0-.576.209-1.073.628-1.492a2.035 2.035 0 0 1 1.491-.628h38.634c.575 0 1.072.21 1.491.628.419.419.628.916.628 1.492v11.066c0 .576-.209 1.073-.628 1.491a2.038 2.038 0 0 1-1.491.628h-26.338v4.945h26.215c.575 0 1.073.21 1.491.628.419.419.628.916.628 1.491v10.204c0 .575-.209 1.072-.628 1.49a2.037 2.037 0 0 1-1.491.629h-26.215v4.944h32.215Z"
                                fill="#fff" />
                            <path fill-rule="evenodd" clip-rule="evenodd"
                                d="M133.242 39.773h10.748V75.72c0 .576.209 1.073.628 1.492.418.418.915.628 1.491.628h16.168c.576 0 1.073-.21 1.492-.628.418-.419.627-.916.627-1.492V39.773h15.377c.576 0 1.073-.209 1.492-.628.418-.418.627-.915.627-1.49l1.498-12.637c0-.576-.209-1.073-.628-1.492a2.035 2.035 0 0 0-1.491-.627h-37.722l-2.756 4.313-7.551 12.561Z"
                                fill="#fff" />
                            <path
                                d="M72.133 49.192c2.04.627 3.794 2.014 5.259 4.16 1.465 2.093 2.197 4.5 2.197 7.22 0 5.808-1.883 10.151-5.65 13.03-3.768 2.825-9.262 4.237-16.483 4.237H25.119c-.575 0-1.072-.209-1.491-.627A2.037 2.037 0 0 1 23 75.72V25.018c0-.576.21-1.073.628-1.492a2.037 2.037 0 0 1 1.491-.628h31.552c7.43 0 12.898 1.36 16.404 4.082 3.558 2.668 5.337 6.723 5.337 12.165v.236c0 2.511-.68 4.657-2.04 6.436-1.361 1.779-2.774 2.904-4.239 3.375Zm-14.991-9.34c0-.942-.288-1.753-.863-2.433-.524-.68-1.309-1.02-2.355-1.02H43.407v7.142h10.517c1.046 0 1.831-.367 2.355-1.1.575-.784.863-1.648.863-2.59ZM54.787 64.34c1.204 0 2.093-.393 2.669-1.178.628-.837.942-1.752.942-2.747v-.078c0-.994-.34-1.858-1.02-2.59-.629-.733-1.492-1.1-2.59-1.1H43.406v7.693h11.38Z"
                                fill="#fff" />
                            <path fill-rule="evenodd" clip-rule="evenodd"
                                d="M75.425 23.609c.239.165.472.336.7.513 4.361 3.282 6.48 8.096 6.727 13.861l12.18 20.235V75.72c0 .576.209 1.073.627 1.492.419.418.916.628 1.492.628h16.717c.576 0 1.073-.21 1.492-.628a2.04 2.04 0 0 0 .628-1.492V58.218l19.778-32.73a2.09 2.09 0 0 0 .236-.941c0-.419-.183-.785-.55-1.099a1.486 1.486 0 0 0-1.177-.55h-16.404c-1.412 0-2.511.655-3.296 1.963l-9.105 15.383-8.869-15.54c-.68-1.204-1.753-1.805-3.218-1.805h-16.56c-.471 0-.89.183-1.256.549a1.672 1.672 0 0 0-.142.16Z"
                                fill="#fff" />
                            <path
                                d="M311.108 62.235c-3.087.157-6.279-.34-9.575-1.492-3.245-1.203-5.992-3.244-8.242-6.122-2.25-2.93-3.374-6.697-3.374-11.302 0-4.029 1.124-7.613 3.374-10.753 2.303-3.139 5.416-5.572 9.34-7.299 3.977-1.779 8.399-2.668 13.265-2.668 4.971 0 9.471.81 13.5 2.433 4.081 1.57 7.299 3.872 9.653 6.907 2.355 2.982 3.532 6.514 3.532 10.595 0 2.617-.523 5.285-1.569 8.006-.995 2.669-3.035 5.808-6.122 9.419l-14.363 16.796c-.367.47-.785.863-1.256 1.177-.471.262-1.073.392-1.805.392h-16.483c-.471 0-.889-.156-1.256-.47a1.875 1.875 0 0 1-.471-1.256c0-.367.105-.707.314-1.02l11.538-13.343Zm11.616-19.308c0-1.622-.654-2.878-1.962-3.768-1.256-.89-2.799-1.334-4.631-1.334-1.831 0-3.401.445-4.709 1.334-1.256.89-1.884 2.146-1.884 3.768 0 1.622.628 2.878 1.884 3.767 1.308.89 2.878 1.334 4.709 1.334 1.832 0 3.375-.444 4.631-1.334 1.308-.89 1.962-2.145 1.962-3.767Z"
                                fill="#fff" />
                            <circle cx="264.004" cy="50.309" r="10.934" fill="#fff" />
                            <path fill-rule="evenodd" clip-rule="evenodd"
                                d="M392.721 73.174c4.866-3.558 7.299-8.817 7.299-15.776V43.113c0-4.657-1.177-8.555-3.532-11.694-2.355-3.192-5.52-5.547-9.497-7.064-3.924-1.57-8.346-2.355-13.264-2.355-4.919 0-9.366.785-13.343 2.355-3.924 1.517-7.064 3.872-9.418 7.064-2.355 3.191-3.532 7.142-3.532 11.851v13.97c0 7.065 2.407 12.376 7.22 15.934 4.814 3.558 11.172 5.337 19.073 5.337 7.849 0 14.18-1.78 18.994-5.337Zm-22-10.963c.866.61 1.868.916 3.006.916 1.413 0 2.616-.497 3.61-1.491.994-.994 1.491-2.198 1.491-3.61V46.473l-8.107 15.738Zm6.227-23.863c-.877-.748-1.951-1.121-3.221-1.121-1.465 0-2.695.497-3.689 1.49-.942.995-1.413 2.198-1.413 3.611v12.177l8.323-16.157Z"
                                fill="#fff" />
                        </svg>
                    </div>
                    <h1 class="card__title">BYTE-90 Firmware Update</h1>
                    <p class="card__description">To update your BYTE-90 firmware, put the device in Update Mode, connect
                        via the provided USB-C cable, and connect to continue.</p>
                </div>
                <div class="card__body">
                    <div class="form-control">
                        <div class="connection-controls">
                            <button class="btn btn-primary" id="connectBtn">Connect</button>
                            <button class="btn btn-muted" id="disconnectBtn" style="display: none;">Disconnect</button>
                        </div>
                    </div>
                    <div class="device-info" id="deviceInfo" style="display: none;">
                        <div class="info-grid">
                            <div class="info-item">
                                <span class="info-label">Firmware Version:</span>
                                <span class="info-value" id="firmwareVersion">--</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">MCU Model:</span>
                                <span class="info-value" id="mcu">--</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Available Space:</span>
                                <span class="info-value" id="availableSpace">--</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Free Heap:</span>
                                <span class="info-value" id="freeHeap">--</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="status-notification" id="connectionStatus"></div>
            </div>
        </div>

        <div class="card-wrapper" id="updateSection" style="display: none;">
            <h2 class="section-title">Firmware or Animations Update</h2>
            <div class="card">
                <div class="card__header">
                    <div class="status-notification status-notice">
                        <div class="status-notification__icon">
                            <svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 -960 960 960" width="24"
                                fill="currentColor">
                                <path
                                    d="M440-280h80v-240h-80v240Zm40-320q17 0 28.5-11.5T520-640q0-17-11.5-28.5T480-680q-17 0-28.5 11.5T440-640q0 17 11.5 28.5T480-600Zm0 520q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 31.5-156T197-763q54-54 127-85.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 83-31.5 156T763-197q-54 54-127 85.5T480-80Zm0-80q134 0 227-93t93-227q0-134-93-227t-227-93q-134 0-227 93t-93 227q0 134 93 227t227 93Zm0-320Z" />
                            </svg>
                        </div>
                        <div>
                            Your device will restart automatically once the firmware update is complete. Make sure to
                            keep the window active during the update process. Do not refresh or close the window.
                        </div>
                    </div>
                </div>
                <div class="card__body">
                    <div class="form-control">
                        <label for="updateType">Update Type</label>
                        <div class="form-select">
                            <select id="updateType">
                                <option value="firmware">Firmware (byte90.bin)</option>
                                <option value="filesystem">Animations (byte90animations.bin)</option>
                            </select>
                            <svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 -960 960 960" width="24"
                                fill="currentColor">
                                <path
                                    d="M480-120 300-300l58-58 122 122 122-122 58 58-180 180ZM358-598l-58-58 180-180 180 180-58 58-122-122-122 122Z" />
                            </svg>
                        </div>
                    </div>
                    <div class="form-control">
                        <label for="firmwareFile">Select Firmware File</label>
                        <input type="file" id="firmwareFile" accept=".bin" required>
                    </div>
                    <div class="progress-bar" id="progressContainer">
                        <progress class="progress-bar__meter" id="uploadProgress" value="0" max="100"></progress>
                        <div class="progress-bar__status" id="progressText">Ready to upload</div>
                    </div>
                </div>
                <div class="card__footer">
                    <div class="btn-group">
                        <button class="btn btn-muted" id="abortBtn" style="display: none;">Abort Update</button>
                        <button class="btn btn-primary" id="uploadBtn" disabled>Start Update</button>
                    </div>
                </div>
                <div class="status-notification" id="updateStatus"></div>
            </div>
        </div>

        <div class="card-wrapper">
            <div class="card">
                <div class="compatibility-status" id="compatibilityStatus">
                    <span class="status-label">Browser compatibility:</span>
                    <span class="status-label" id="serialSupport">Checking...</span>
                </div>
                <p class="card__description">This updater requires a browser with Web Serial API support. Please
                    use the latest version of <strong>Chrome</strong> or <strong>Edge</strong>. Mobile browsers, Safari,
                    and Firefox are not supported.</p>
            </div>
        </div>
    </main>
    <script src="script.js"></script>
</body>

</html>